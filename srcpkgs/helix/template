# Template file for 'helix'
pkgname=helix
version=0.6.0
revision=1
build_style=cargo
hostmakedepends="git"
short_desc="A post-modern modal text editor"
maintainer="Tiago Carvalho <t1ago_@outlook.com>"
license="MPL-2.0"
homepage="https://helix-editor.com"

do_fetch() {
	if [ ! -d helix-${version} ]; then
		git clone --depth=1 -b v${version} \
			https://github.com/helix-editor/helix \
			helix-${version}
		cd helix-${version}
		git submodule update --init --recursive --depth=1
		cd ..
	fi
}

do_install() {
	# Install MPL-2.0
	vlicense LICENSE

	# Install the built binary
	if [ "$CROSS_BUILD" ]; then
		_target=$XBPS_CROSS_RUST_TARGET
	else
		_target=$XBPS_TRIPLET
	fi

	vbin target/${_target}/release/hx

	# Install docs
	vmkdir usr/share/doc/${pkgname}
	cp -r book/* ${DESTDIR}/usr/share/doc/${pkgname}/
}
